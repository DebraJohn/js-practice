<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="./index.css" />
    <script src="../../jquery-3.3.1.min.js"></script>
  </head>

  <body>
    <div class="content">
      <div class="left_content">
        <div class="title">
          <ul id="menuList">

          </ul>
        </div>
      </div>
      <div class="right_content">
        <div class="contoiner">
          <div class="message">
            <img src="./images/wifi-icon.png" alt="" class="wi-fi" />
            <div class="date">07.14</div>
            <div class="week">WEN</div>
            <div class="time">12:30</div>
          </div>
          <div class="r_title">
            <span class="apps">APPS</span>
            <span class="sports">Sports</span>
          </div>
          <div class="r_content" id="r_content">
            //右边的内容也是通过接口获取的
          </div>
          <div class="choose_color"></div>
        </div>
      </div>
    </div>
  </body>
  <script>

    var myDate = null;//定义一个变量，用来存放接口拿到的数据
    $.ajax({
      async: true,
      type: 'get',
      url: 'http://dev-smarttv.zeasn.tv/BluePortServlets/launcher/menuApp',
      data: {
        productid: '329',
        spproductid: '329',
        brandid: '8',
        categoryid: 'c6d19f5dc47611e7936b06bc92f2b7c5',
        osver: '0.6.0',
        ostype: 'linux'
      },
      datatype: 'jsonp',
      success: function(res) {
        myDate = res.datas;
        //此时myDate里面就是存放着接口的数据；
        console.log(myDate);
        innerTitle(myDate);
        handleRightContent()
      },
      error: function() {
        alert('错误');
      }
    });


    //1.输出菜单方法
    function innerTitle(data) {

      var titlelist = document.getElementById('menuList')
      console.log(titlelist);
      var totallist = '';
      for (var i = 0; i < data.length ; i++){
        totallist += `
        <li data-index = '${i}' class = 'menuItem' tabindex="-1">${data[i].title.toUpperCase()}</li>`
      }
      titlelist.innerHTML = totallist;
    }

    //2.处理右侧内容
    function handleRightContent() {
      var $menuItems = $(".menuItem");
      $menuItems[0].focus();
      innerBox(0);//默认聚焦为0
      $menuItems.focus(function(){
        var index = $(this).attr("data-index")
        innerBox(index);//调用innerBox函数，并传入index
      });
    }

    //输出内容盒子方法
    function innerBox(index) {
      var content_box = document.getElementById('r_content');
      var thisboxData = myDate[index].datas;
      var totalHTML = '';
      for (var i = 0; i < thisboxData.length; i++) {
        totalHTML += `
            <div class="content_box">
              <div class='default'><img src="${thisboxData[i].thumbnail}" alt=""></div>
              <div class="content_title">
                <span>${thisboxData[i].title}</span>
              </div>
            </div>`;
      }
      content_box.innerHTML = totalHTML;
    }
  </script>
</html>
